import "@wictorwilen/cocogen";
using coco;

// People connectors use Graph /beta. Use --use-preview-features with cocogen validate/generate/update.
// Optional: set defaults for profile source registration.
// @coco.profileSource({ webUrl: "https://contoso.com/people", displayName: "Contoso HR", priority: "first" })

@coco.connection({
  contentCategory: "people",
  name: "Awards people connector",
  connectionId: "peopleawards",
  connectionDescription: "People awards connector generated by cocogen"
})
@coco.profileSource(
  {
    webUrl: "https://contoso.com/awards",
    displayName: "Contoso Awards",
    priority: "last",
  }
)
@TypeSpec.doc("People profiles with awards and recognitions.")
@coco.item()
model PersonProfile {
  @coco.id
  @coco.label("personAccount")
  @TypeSpec.example("maria@contoso.com")
  @TypeSpec.format("email")
  @coco.source("UPN", "userPrincipalName")
  account: string;

  @coco.label("personAwards")
  @coco.source("Awards", "displayName")
  @TypeSpec.example(#["Employee of the Month", "Top Innovator 2024"])
  awards: string[];
}

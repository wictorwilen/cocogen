import "@wictorwilen/cocogen";
using coco;

@coco.connection({
  contentCategory: "people",
  name: "People connector",
  connectionId: "peopleconnector",
  connectionDescription: "People connector generated by cocogen"
})
@coco.profileSource({
  webUrl: "https://example.com/people",
  displayName: "Example People Directory",
  priority: "first"
})
@doc("People profiles synchronized into Microsoft 365.")
@coco.item()
model PersonProfile {
  @coco.id
  @coco.label("personAccount")
  @coco.schemaDescription("Unique identifier for this person profile.")
    @doc("User principal name used to identify the person.")
    @example("alex@contoso.com")
    @format("email")
  @coco.source("upn", "userPrincipalName")
  userPrincipalName: string;

  @coco.label("personName")
  @coco.schemaDescription("Preferred display name for this person.")
    @doc("Display name shown in people search results.")
    @example("Alex Wilber")
    @minLength(2)
    @maxLength(128)
  @coco.source("displayName", "displayName")
  displayName: string;

  @coco.label("personCurrentPosition")
  @coco.schemaDescription("Current work position mapped from source fields.")
    @example("Senior Software Engineer")
  @coco.source("job title", "detail.jobTitle")
  @coco.source("company", "detail.company.displayName")
  @coco.source("employee id", "detail.employeeId")
  workPosition: string;

  @coco.label("personEmails")
  @coco.schemaDescription("Email addresses associated with this person.")
    @example(#["alex@contoso.com", "alex.wilber@contoso.com"])
  @coco.source("email", "address")
  @coco.source("email type", "type")
  emails: string[];

  @coco.label("personPhones")
  @coco.schemaDescription("Phone numbers associated with this person.")
  @coco.source("phone", "number")
  @coco.source("phone type", "type")
  phones: string[];

  @coco.label("personNote")
  @coco.schemaDescription("Short bio or summary for this person.")
    @example("Customer success leader based in Seattle.")
  @coco.source("bio", "detail")
  bio: string;

  // Example of a principal field for ACL-like data (schema propertyType=principal).
  // NOTE: This is NOT a people-domain labeled property.
  @coco.schemaDescription("Manager identity for this person.")
  manager: coco.Principal;

  // Example of a principal collection (schema propertyType=principalCollection).
  // NOTE: This is NOT a people-domain labeled property.
  @coco.schemaDescription("Delegated approvers for this person.")
  @coco.source("approver upn", "userPrincipalName")
  @coco.source("approver tenant", "tenantId")
  approvers: coco.Principal[];
}

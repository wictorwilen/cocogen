import "@wictorwilen/cocogen";
using coco;

@coco.connection({
  contentCategory: "people",
  name: "People connector",
  connectionId: "peopleconnector",
  connectionDescription: "People connector generated by cocogen"
})
@coco.profileSource({
  webUrl: "https://example.com/people",
  displayName: "Example People Directory",
  priority: "first"
})
@TypeSpec.doc("People profiles synchronized into Microsoft 365.")
@coco.item()
model PersonProfile {
  @coco.id
  @coco.label("personAccount")
  @coco.description("Unique identifier for this person profile.")
    @TypeSpec.doc("User principal name used to identify the person.")
    @TypeSpec.example("alex@contoso.com")
    @TypeSpec.format("email")
  @coco.source("upn", "userPrincipalName")
  userPrincipalName: string;

  @coco.label("personName")
  @coco.description("Preferred display name for this person.")
    @TypeSpec.doc("Display name shown in people search results.")
    @TypeSpec.example("Alex Wilber")
    @TypeSpec.minLength(2)
    @TypeSpec.maxLength(128)
  @coco.source("displayName", "displayName")
  displayName: string;

  @coco.label("personCurrentPosition")
  @coco.description("Current work position mapped from source fields.")
    @TypeSpec.example("Senior Software Engineer")
  @coco.source("job title", "detail.jobTitle")
  @coco.source("company", "detail.company.displayName")
  @coco.source("employee id", "detail.employeeId")
  workPosition: string;

  @coco.label("personEmails")
  @coco.description("Email addresses associated with this person.")
    @TypeSpec.example(#["alex@contoso.com", "alex.wilber@contoso.com"])
  @coco.source("email", "address")
  emails: string[];

  @coco.label("personPhones")
  @coco.description("Phone numbers associated with this person.")
  @coco.source("phone", "number")
  phones: string[];

  @coco.label("personNote")
  @coco.description("Short bio or summary for this person.")
    @TypeSpec.example("Customer success leader based in Seattle.")
  @coco.source("bio", "detail")
  bio: string;

  // Example of a principal field for ACL-like data (schema propertyType=principal).
  // NOTE: This is NOT a people-domain labeled property.
  @coco.description("Manager identity for this person.")
  manager: coco.Principal;
}
